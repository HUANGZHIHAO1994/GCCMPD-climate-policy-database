import pandas as pd
import json
import os
import sys

print("================== {} ==================".format(os.path.basename(sys.argv[0])))

if __name__ == '__main__':
    df = pd.read_csv("lse.csv")

    # ================== Reference ==================
    # ipcc_wg3_ar5_chapter15 table15.1/ipcc_wg3_ar5_chapter6 table6.7

    # ================== View the objective classification in lse ==================
    # print(set(df["Keywords"].str.strip().str.replace(",  ", ',').str.replace(", ", ',').str.cat(sep=',').split(',')))
    # print(
    #     len(set(df["Keywords"].str.strip().str.replace(",  ", ',').str.replace(", ", ',').str.cat(sep=',').split(','))))

    # ================== update database should use set diff ==================
    # df_old = pd.read_csv("laws_and_policies_11092021.csv")
    # key_old = set(df_old["Keywords"].str.strip().str.replace(",  ", ',').str.replace(", ", ',').str.cat(sep=',').split(','))
    # key_new = set(df["Keywords"].str.strip().str.replace(",  ", ',').str.replace(", ", ',').str.cat(sep=',').split(','))
    # print(key_new - key_old)

    # ================== Notes ==================
    # First element of list: objective
    # Second element of list: Sub-objective
    # First one "" means skip
    # Second one "" means only objective

    lse_objective = dict()

    lse_objective['5G'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Adaptation'] = ['', '']
    lse_objective['Afforestation'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Agriculture'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Air Pollution'] = ['Social;Environmental', 'Social:Health impact;Environmental:Ecosystem impact']
    lse_objective['air pollution'] = ['Social;Environmental', 'Social:Health impact;Environmental:Ecosystem impact']
    lse_objective['Amazon Forest'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Arctic'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Argentina'] = ['', '']
    lse_objective['Aviation'] = ['', '']
    lse_objective['Ban'] = ['', '']
    lse_objective['Banking'] = ['Economic', '']
    lse_objective['Biodiversity'] = ['Environmental', 'Environmental:Biodiversity conservation']
    lse_objective['Biofuels'] \
        = ['Environmental;Economic', 'Environmental:Ecosystem impact;Economic:Energy security']
    lse_objective['Biogas'] = ['Social', 'Social:Energy/mobility access']
    lse_objective['Biomass'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Brt'] = ['Social', '']
    lse_objective['Buildings'] = ['', '']
    lse_objective['Cap And Trade'] = ['', '']
    lse_objective['Car Manufacturing'] = ['', '']
    lse_objective['Car manufacturing'] = ['', '']
    lse_objective['Carbon Accounting'] = ['', '']
    lse_objective['Carbon Budget'] = ['', '']
    lse_objective['Carbon Capture And Storage'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Carbon Pricing'] = ['', '']
    lse_objective['Carbon Sink'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Ccs'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Cdm'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Central Bank'] = ['', '']
    lse_objective['Circular Economy'] = ['Economic', '']
    lse_objective["Citizens' Assembly"] = ['Social', '']
    lse_objective['Climate Change'] = ['', '']
    lse_objective['Climate Change Risks'] = ['', '']
    lse_objective['Climate Fund'] = ['Economic', '']
    lse_objective['Climate Neutrality'] = ['', '']
    lse_objective['Co Benefits'] = ['', '']
    lse_objective['Coal'] = ['', '']
    lse_objective['Coal Mining'] = ['Social', 'Social:Energy/mobility access']
    lse_objective['Coastal Erosion'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Coastal erosion'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Cogeneration'] = ['', '']
    lse_objective['Covid 19'] = ['Social', 'Social:Health impact']
    lse_objective['Covid19'] = ['Social', 'Social:Health impact']
    lse_objective['Cycling'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Debt For Nature'] = ['', '']
    lse_objective['Deforestation'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Digital Transition'] = ['Social', 'Social:Energy/mobility access']
    lse_objective['Disaster Risk Management'] = ['Social', 'Social:Safety/disaster resilience']
    lse_objective['Disclosure'] = ['', '']
    lse_objective['Disease Prevention'] = ['Social', 'Social:Health impact']
    lse_objective['Divestment'] = ['', '']
    lse_objective['E Vs'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['ETS'] = ['Economic', '']
    lse_objective['EV'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Education'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Electricity'] = ['Economic', 'Economic:Energy security']
    lse_objective['Energy'] = ['Economic', 'Economic:Energy security']
    lse_objective['Energy Demand'] = ['Social', 'Social:Energy/mobility access']
    lse_objective['Energy Efficiency'] = ['Economic', 'Economic:Productivity/competitiveness']
    lse_objective['Energy Supply'] = ['Social', 'Social:Energy/mobility access']
    lse_objective['Energy storage'] = ['Social', 'Social:Energy/mobility access']
    lse_objective['Environmental Permit'] = ['Economic', '']
    lse_objective['European Green Deal'] = ['', '']
    lse_objective['Ev'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Finance'] = ['Economic', '']
    lse_objective['Fisheries'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Fit'] = ['', '']
    lse_objective['Food Security'] = ['Social', 'Social:Health impact;Social:Food security']
    lse_objective['Forest'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Forests'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Fossil Fuels'] = ['Economic', 'Economic:Energy security']
    lse_objective['Fossil Fuels Subsidies'] = ['Economic', '']
    lse_objective['Fossil fuels'] = ['Economic', 'Economic:Energy security']
    lse_objective['Gas'] = ['Economic', 'Economic:Energy security']
    lse_objective['Gender'] = ['Social', 'Social:Gender impact']
    lse_objective['Geothermal'] = ['Environmental', 'Environmental:Urban heat island effect']
    lse_objective['Germany'] = ['', '']
    lse_objective['Ghg'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Governance'] = ['', '']
    lse_objective['Green Bonds'] = ['Economic', '']
    lse_objective['Green New Deal'] = ['', '']
    lse_objective['Health'] = ['Social', 'Social:Health impact']
    lse_objective['Heat'] = ['', '']
    lse_objective['Human rights'] = ['Social', '']
    lse_objective['Hydrogen'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Industry'] = ['', '']
    lse_objective['Infrastructure'] = ['', '']
    lse_objective['Institutions / Administrative Arrangements'] = ['', '']
    lse_objective['Insurance'] = ['Economic', '']
    lse_objective['Jobs'] = ['Economic', 'Economic:Employment impact']
    lse_objective['Joe Biden'] = ['', '']
    lse_objective['Just Transition'] = ['', '']
    lse_objective['K-ETS'] = ['Economic', '']
    lse_objective['Keystone'] = ['', '']
    lse_objective['Land use'] = ['Environmental', 'Environmental:Land-use competition']
    lse_objective['Limits on fossil fuels'] = ['Economic', 'Economic:Energy security']
    lse_objective['Lulucf'] = ['Environmental', 'Environmental:Ecosystem impact;Environmental:Land-use competition']
    lse_objective['Maritime Planning'] = ['', '']
    lse_objective['Meat'] = ['Social', 'Social:Food security']
    lse_objective['Methane'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Mitigation'] = ['', '']
    lse_objective['Mountain'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['NAP'] = ['', '']
    lse_objective['National Energy And Climate Plans'] = ['', '']
    lse_objective['National Security'] = ['Social', 'Social:Safety/disaster resilience']
    lse_objective['Net Zero'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['No Adequate Category'] = ['', '']
    lse_objective['Offshore'] = ['', '']
    lse_objective['Oil'] = ['Economic', 'Economic:Energy security']
    lse_objective['Oil and gas'] = ['Economic', 'Economic:Energy security']
    lse_objective['Paris Agreement'] = ['', '']
    lse_objective['Peat'] = ['Economic', 'Economic:Energy security']
    lse_objective['Permit'] = ['', '']
    lse_objective['Physical Activity'] = ['Social', 'Social:Health impact']
    lse_objective['Planning'] = ['', '']
    lse_objective['Public Private'] = ['', '']
    lse_objective['Public Transport'] = ['', '']
    lse_objective['Pv'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Redd+ And Lulucf'] \
        = ['Environmental', 'Environmental:Ecosystem impact;Environmental:Land-use competition']
    lse_objective['Reforestation'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Reinsurance'] = ['Economic', '']
    lse_objective['Renewables'] = ['', '']
    lse_objective['Research And Development'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['S Olar'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['SDGs'] = ['', '']
    lse_objective['Shipping'] = ['', '']
    lse_objective['Skills'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Social Justice'] = ['Social', '']
    lse_objective['Solar Panels'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Spatial Planning'] = ['', '']
    lse_objective['Stimulus Plan'] = ['Economic', '']
    lse_objective['Stimulus plan'] = ['Economic', '']
    lse_objective['Subsidies'] = ['Economic', '']
    lse_objective['Tax'] = ['Economic', '']
    lse_objective['Tax Incentives'] = ['Economic', '']
    lse_objective['Taxes'] = ['Economic', '']
    lse_objective['Tourism'] = ['Economic', '']
    lse_objective['Trading Scheme'] = ['Economic', '']
    lse_objective['Train'] = ['Economic', 'Economic:Technological spillover/innovation']
    lse_objective['Transport'] = ['', '']
    lse_objective['Transportation'] = ['', '']
    lse_objective['Trees'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Unfccc'] = ['', '']
    lse_objective['Walking'] = ['Social', 'Social:Health impact']
    lse_objective['Waste'] = ['', '']
    lse_objective['Water'] = ['Social;Environmental', 'Social:Health impact;Environmental:Water use/quality']
    lse_objective['Water Management'] = ['Environmental', 'Environmental:Water use/quality']
    lse_objective['bus'] = ['', '']
    lse_objective['carbon sink'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['ccGAP'] = ['', '']
    lse_objective['climate justice'] = ['', '']
    lse_objective['coal phase out'] = ['', '']
    lse_objective['covid19'] = ['Social', 'Social:Health impact']
    lse_objective['development'] = ['', '']
    lse_objective['energy conservation'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['fossil fuel phase out'] = ['Economic', 'Economic:Energy security']
    lse_objective['fossil fuels curbing measures'] = ['Economic', 'Economic:Energy security']
    lse_objective['infrastructure'] = ['', '']
    lse_objective['licensing'] = ['', '']
    lse_objective['modal shift'] = ['Social', 'Social:Health impact']
    lse_objective['moratorium'] = ['', '']
    lse_objective['truck'] = ['', '']

    lse_objective['Advertising'] = ['', '']
    lse_objective['Black carbon'] = ['', '']
    lse_objective['CBDR'] = ['', '']  # Common But Differentiated Responsibilities
    lse_objective['Cap and Trade'] = ['', '']
    lse_objective['Climate protection'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Delta'] = ['', '']
    lse_objective['Development'] = ['Economic', 'Economic:New business opportunity / economic activity']
    lse_objective['E-buses'] = ['', '']
    lse_objective['FIT'] = ['', '']
    lse_objective['Food'] = ['Social', 'Social:Food security']
    lse_objective['HFCs'] = ['', '']
    lse_objective['Healthy environment'] = ['Social', 'Social:Health impact']
    lse_objective['Indigenous people'] = ['Social', '']
    lse_objective['MRV'] = ['', '']  # Measurement, Reporting, and Verification
    lse_objective['Migration'] = ['', '']
    lse_objective['Moratorium'] = ['Environmental', 'Environmental:Biodiversity conservation']
    lse_objective['Nuclear'] = ['', '']
    lse_objective['Nuclear fusion'] = ['', '']
    lse_objective['Oceans'] = ['Environmental', 'Environmental:Biodiversity conservation']
    lse_objective['Procurement'] = ['', '']
    lse_objective['Rail'] = ['', '']
    lse_objective['Road'] = ['', '']
    lse_objective['SLCPs'] = ['', '']
    lse_objective['Soil erosion'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['Youth'] = ['', '']
    lse_objective['active travel'] = ['', '']
    lse_objective['artificialisation'] = ['', '']
    lse_objective['buses'] = ['', '']
    lse_objective['carbon capture and storage'] = ['', '']
    lse_objective['carbon credits'] = ['', '']
    lse_objective['climate finance'] = ['', '']
    lse_objective['co-benefits'] = ['', '']
    lse_objective['culture'] = ['', '']
    lse_objective['desertification'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['drr'] = ['', '']  # Disaster risk reduction
    lse_objective['environmental degradation'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['equity'] = ['', '']
    lse_objective['flaring'] = ['', '']
    lse_objective['food waste'] = ['', '']
    lse_objective['freight'] = ['', '']
    lse_objective['fuels'] = ['', '']
    lse_objective['glaciers'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['governance'] = ['', '']
    lse_objective['greenwashing'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['housing'] = ['', '']
    lse_objective['hydro'] = ['', '']
    lse_objective['hydrofluorocarbons'] = ['', '']
    lse_objective['innovation'] = ['', '']
    lse_objective['intergenerational'] = ['', '']
    lse_objective['livestock'] = ['', '']
    lse_objective['mangroves'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['meteorology'] = ['', '']
    lse_objective['mining'] = ['', '']
    lse_objective['multi-modal transport'] = ['', '']
    lse_objective['natural resources'] = ['Environmental', 'Environmental:Resource / material use impact']
    lse_objective['nitrous oxide'] = ['', '']
    lse_objective['off-grid'] = ['', '']
    lse_objective['ozone'] = ['', '']
    lse_objective['power plant'] = ['', '']
    lse_objective['rail'] = ['', '']
    lse_objective['rivers'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['space'] = ['', '']
    lse_objective['technology'] = ['', '']
    lse_objective['wetlands'] = ['Environmental', 'Environmental:Ecosystem impact']
    lse_objective['wind'] = ['', '']

    with open('lse_objective_dict.json', 'w') as f:
        json.dump(lse_objective, f)
